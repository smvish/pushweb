<!DOCTYPE html>
<html>

<head>

</head>

<body>
  <button onclick="subscribe()">subscribe</button>
  <script>
    addEventListener('load',async()=>{
      // let sw = await navigator.serviceWorker.register('./sw.js')
      // console.log(sw);
//       Notification.requestPermission().then(function(result) {
//   console.log(result);
// });
Notification.requestPermission(function(permission) {
  console.log(permission);
      });
      if ('serviceWorker' in navigator) {
       navigator.serviceWorker.register('sw.js').then(function(reg) {
       console.log('Service Worker Registered!', reg);

        reg.pushManager.getSubscription().then(function(sub) {
          if (sub === null) {
            // Update UI to ask user to register for Push
            console.log('Not subscribed to push service!');
          } else {
            // We have a subscription, update the database
            console.log('Subscription object: ', sub);
          }
        });
  })
   .catch(function(err) {
    console.log('Service Worker registration failed: ', err);
  });
}
    })
    async function subscribe(){
      let sw = await navigator.serviceWorker.ready;
      let push = await sw.pushManager.subscribe({
        userVisibleOnly:true,
        applicationServerKey:'BCAtEnGAsTLmzty-PDEp3nLFkecOwLkr5U5RRdhxzBa4WKftioudoI8T5U5haZBfgNUJcifLaRvi9MbqKeiJYhs'
      })
      console.log(JSON.stringify(push));
    }
  </script>
</body>


</html>